function loadData(a,e){(a=a||Object.keys(OPEN_COVID_CONFIG.tables)).forEach((a=>function(a,t){const o=Math.round(Date.now()/1e3/60),n=`${OPEN_COVID_CONFIG["data-url"]}/v2/${t}`;$.getJSON(`${n}?cache=${o}`,(t=>e(a,t)))}(a,a+".json")))}async function loadLocationData(a){return console.log(`${CURRENT_OPTIONS["cod-data-url"]}/${a}/main.json`),"CSV"===CURRENT_OPTIONS["read-format"]?await loadCSV(`${CURRENT_OPTIONS["cod-data-url"]}/${a}/main.csv`):tableToRecords(await loadJSON(`${CURRENT_OPTIONS["cod-data-url"]}/${a}/main.json`))}function tableToRecords(a){return a.data.map((e=>a.columns.reduce(((a,t,o)=>Object.assign(a,{[t]:e[o]})),{})))}function removeEmptyColumns(a){const e=[];return a.forEach((a=>{Object.keys(a).forEach((t=>{a[t]&&e.push(t)}))})),a.map((a=>e.reduce(((e,t)=>Object.assign(e,{[t]:a[t]})),{})))}function retryCallback(a){let e=0;const t=setInterval((()=>{try{a(),clearInterval(t)}catch(a){console.error("Callback failed: "+ ++e,a),e>=32&&clearInterval(t)}}),250)}async function loadResource(a){const e=await fetch(a);if(e.ok)return e;throw new Error("Response failed")}function loadJSON(a,e=!1){return a in CACHE.JSON||(CACHE.JSON[a]=new Promise((async(t,o)=>{e&&(a="https://cors-anywhere.herokuapp.com/"+a),t((await loadResource(a)).json())}))),CACHE.JSON[a]}function loadCSV(a,e=!1){return a in CACHE.CSV||(CACHE.CSV[a]=new Promise((async(t,o)=>{e&&(a="https://cors-anywhere.herokuapp.com/"+a);const n=await loadResource(a),r=await n.text();Papa.parse(r,{header:!0,skipEmptyLines:!0,complete:a=>{a.errors.length>0?o(a.errors[0]):t(a.data)}})}))),CACHE.CSV[a]}function recordsToDataTable(a,e=null){const t=[e=e||Object.keys(a[0])].concat(a.map((a=>e.map((e=>a[e])))));return google.visualization.arrayToDataTable(t)}function loadGoogleCharts(a=["corechart"]){const e=a.join(",");return e in CACHE.gcharts||(CACHE.gcharts[e]=google.charts.load("current",{packages:a})),CACHE.gcharts[e]}function filterDataIndices(a){let e=a.map(((a,e)=>Object.assign({},a,{idx:e})));if(CURRENT_OPTIONS["skip-until-outbreak"]){const t=CURRENT_OPTIONS["outbreak-threshold-ratio"],o=Math.max(...a.filter((a=>a.date<"2020-06-01")).map((a=>a.new_confirmed))),n=a.map(((a,e)=>(Number(a.new_confirmed)||0)/t>o?e:null)).filter((a=>a))[0];e=e.slice(n)}const t=["new_confirmed","new_deceased"];for(;t.every((a=>""===e.slice(-1)[0][a]));)e.pop();return"ontouchstart"in document.documentElement&&(e=e.slice(-CURRENT_OPTIONS["history-size-mobile"])),e.map((a=>a.idx))}function mapToNumeric(a,e,t=!0){return a.map((a=>{const o=Object.assign({},a);return e.forEach((a=>{const e=Number(o[a]);null===o[a]||Number.isNaN(e)?o[a]=Number.NaN:o[a]=t?Math.max(0,e):e})),o}))}