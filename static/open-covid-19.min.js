function loadData(e,a){(e=e||Object.keys(OPEN_COVID_CONFIG.tables)).forEach((e=>function(e,t){const o=Math.round(Date.now()/1e3/60),n=`${OPEN_COVID_CONFIG["data-url"]}/v2/${t}`;$.getJSON(`${n}?cache=${o}`,(t=>a(e,t)))}(e,`${e}.json`)))}async function loadLocationData(e){return"CSV"===CURRENT_OPTIONS["read-format"]?await loadCSV(`${CURRENT_OPTIONS["data-url"]}/v3/location/${e}.csv`):tableToRecords(await loadJSON(`${CURRENT_OPTIONS["data-url"]}/v3/location/${e}.json`))}function tableToRecords(e){return e.data.map((a=>e.columns.reduce(((e,t,o)=>Object.assign(e,{[t]:a[o]})),{})))}function removeEmptyColumns(e){const a=[];return e.forEach((e=>{Object.keys(e).forEach((t=>{e[t]&&a.push(t)}))})),e.map((e=>a.reduce(((a,t)=>Object.assign(a,{[t]:e[t]})),{})))}function retryCallback(e){let a=0;const t=setInterval((()=>{try{e(),clearInterval(t)}catch(e){console.error("Callback failed: "+ ++a,e),a>=32&&clearInterval(t)}}),250)}async function loadResource(e){const a=await fetch(e);if(a.ok)return a;throw new Error("Response failed")}function loadJSON(e,a=!1){return e in CACHE.JSON||(CACHE.JSON[e]=new Promise((async(t,o)=>{a&&(e=`https://cors-anywhere.herokuapp.com/${e}`),t((await loadResource(e)).json())}))),CACHE.JSON[e]}function loadCSV(e,a=!1){return e in CACHE.CSV||(CACHE.CSV[e]=new Promise((async(t,o)=>{a&&(e=`https://cors-anywhere.herokuapp.com/${e}`);const n=await loadResource(e),r=await n.text();Papa.parse(r,{header:!0,skipEmptyLines:!0,complete:e=>{e.errors.length>0?o(e.errors[0]):t(e.data)}})}))),CACHE.CSV[e]}function recordsToDataTable(e,a=null){const t=[a=a||Object.keys(e[0])].concat(e.map((e=>a.map((a=>e[a])))));return google.visualization.arrayToDataTable(t)}function loadGoogleCharts(e=["corechart"]){const a=e.join(",");return a in CACHE.gcharts||(CACHE.gcharts[a]=google.charts.load("current",{packages:e})),CACHE.gcharts[a]}function filterDataIndices(e,a=0,t=null){let o=e.map(((e,a)=>Object.assign({},e,{idx:a})));if(CURRENT_OPTIONS["skip-until-outbreak"]){const t=CURRENT_OPTIONS["outbreak-threshold-ratio"],n=Math.max(...e.filter((e=>e.date<"2020-06-01")).map((e=>!Number.isNaN(e.new_confirmed)))),r=e.map(((e,a)=>(Number(e.new_confirmed)||0)/t>n?a:null)).filter((e=>e))[0];o=o.slice(Math.max(0,r-a))}const n=t||["new_confirmed","new_deceased"];for(;n.every((e=>Number.isNaN(o.slice(-1)[0][e])));)o.pop();return"ontouchstart"in document.documentElement&&(o=o.slice(-CURRENT_OPTIONS["history-size-mobile"]-a)),o.map((e=>e.idx))}function mapToNumeric(e,a,t=!0){return a=a.concat(["new_confirmed","new_deceased"]),e.map((e=>{const o=Object.assign({},e);return a.forEach((e=>{const a=Number(o[e]);null===o[e]||Number.isNaN(a)?o[e]=Number.NaN:o[e]=t?Math.max(0,a):a})),o}))}