function setting(e,a){null===a?sessionStorage.removeItem(e):sessionStorage.setItem(e,a)}function loadData(e,a){(e=e||Object.keys(OPEN_COVID_CONFIG.tables)).forEach((e=>function(e,t){const n=Math.round(Date.now()/1e3/60),o=`${OPEN_COVID_CONFIG["data-url"]}/v2/${t}`;$.getJSON(`${o}?cache=${n}`,(t=>a(e,t)))}(e,`${e}.json`)))}async function loadLocationData(e){return"CSV"===CURRENT_OPTIONS["read-format"]?await loadCSV(`${CURRENT_OPTIONS["data-url"]}/v3/location/${e}.csv`):tableToRecords(await loadJSON(`${CURRENT_OPTIONS["data-url"]}/v3/location/${e}.json`))}function tableToRecords(e){return e.data.map((a=>e.columns.reduce(((e,t,n)=>Object.assign(e,{[t]:a[n]})),{})))}function removeEmptyColumns(e){const a=[];return e.forEach((e=>{Object.keys(e).forEach((t=>{e[t]&&a.push(t)}))})),e.map((e=>a.reduce(((a,t)=>Object.assign(a,{[t]:e[t]})),{})))}function retryCallback(e){let a=0;const t=setInterval((()=>{try{e(),clearInterval(t)}catch(e){console.error("Callback failed: "+ ++a,e),a>=32&&clearInterval(t)}}),250)}async function loadResource(e){const a=await fetch(e);if(a.ok)return a;throw new Error("Response failed")}function loadJSON(e,a=!1){return e in CACHE.JSON||(CACHE.JSON[e]=new Promise((async(t,n)=>{a&&(e=`https://cors-anywhere.herokuapp.com/${e}`),t((await loadResource(e)).json())}))),CACHE.JSON[e]}function loadCSV(e,a=!1){return e in CACHE.CSV||(CACHE.CSV[e]=new Promise((async(t,n)=>{a&&(e=`https://cors-anywhere.herokuapp.com/${e}`);const o=await loadResource(e),r=await o.text();Papa.parse(r,{header:!0,skipEmptyLines:!0,complete:e=>{e.errors.length>0?n(e.errors[0]):t(e.data)}})}))),CACHE.CSV[e]}function recordsToDataTable(e,a=null){const t=[a=a||Object.keys(e[0])].concat(e.map((e=>a.map((a=>e[a])))));return google.visualization.arrayToDataTable(t)}function loadGoogleCharts(e=["corechart"]){const a=e.join(",");return a in CACHE.gcharts||(CACHE.gcharts[a]=google.charts.load("current",{packages:e})),CACHE.gcharts[a]}function filterDataIndices(e,a=0,t=null){let n=e.map(((e,a)=>Object.assign({},e,{idx:a})));if(CURRENT_OPTIONS["skip-until-outbreak"]){const t=CURRENT_OPTIONS["outbreak-threshold-ratio"],o=Math.max(...e.filter((e=>e.date<"2020-06-01"&&!Number.isNaN(e.new_confirmed))).map((e=>e.new_confirmed))),r=e.map(((e,a)=>(Number(e.new_confirmed)||0)/t>o?a:null)).filter((e=>e))[0];n=n.slice(Math.max(0,r-a))}const o=t||["new_confirmed","new_deceased"];for(;o.every((e=>Number.isNaN(n.slice(-1)[0][e])));)n.pop();return"ontouchstart"in document.documentElement&&(n=n.slice(-CURRENT_OPTIONS["history-size-mobile"]-a)),n.map((e=>e.idx))}function mapToNumeric(e,a,t=!0){return a=a.concat(["new_confirmed","new_deceased"]),e.map((e=>{const n=Object.assign({},e);return a.forEach((e=>{const a=parseInt(n[e]);null===n[e]||Number.isNaN(a)?n[e]=Number.NaN:n[e]=t?Math.max(0,a):a})),n}))}function chartLabel(e){const a=document.querySelector("#location-title").innerText;return e+(CURRENT_OPTIONS["shareable-charts"]?` in ${a}`:"")}