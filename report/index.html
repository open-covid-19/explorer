<!DOCTYPE html><html><!-- HTML page head --><head>
    <!-- HTML metadata -->
    <meta charset="UTF-8">
    <title>COVID-19 Open Data Explorer</title>
    <meta name="description" content="Interactive map for the COVID-19 Open Data Project">
    <link rel="icon" type="image/png" href="../static/logo-64.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="COVID-19 Open Data Explorer">

    <!-- Homescreen icons -->
    <link rel="apple-touch-icon" href="../static/icon-64x64.png">
    <link rel="apple-touch-icon" sizes="64x64" href="../static/icon-64x64.png">
    <link rel="apple-touch-icon" sizes="128x128" href="../static/icon-128x128.png">
    <link rel="apple-touch-icon" sizes="512x512" href="../static/icon-512x512.png">

    <!-- Capabilities-related metadata -->
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <!-- Google Fonts -->
    <link href="//fonts.googleapis.com/css?family=Roboto:100,300,400,500,700|Google+Sans:400,500|Product+Sans:400&amp;lang=en" rel="stylesheet">

    <!-- JQuery and plugins -->
    <script type="text/javascript" src="../third_party/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="../third_party/jquery-ui-dist/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../third_party/jqvmap/dist/jquery.vmap.min.js"></script>
    <script type="text/javascript" src="../static/jquery.ui.combobox.min.js"></script>
    <link rel="stylesheet" href="../third_party/jquery-ui-dist/jquery-ui.min.css">

    <!-- Google Charts -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <!-- MomentJS -->
    <script type="text/javascript" src="../third_party/moment/min/moment.min.js"></script>

    <!-- CSV Parsing -->
    <script type="text/javascript" src="../third_party/papaparse/papaparse.min.js"></script>

    <!-- Character transliteration -->
    <script type="text/javascript" src="../third_party/transliteration/dist/browser/bundle.umd.min.js"></script>

    <!-- Custom styles -->
    <link rel="stylesheet" href="https://pair-code.github.io/covid19_symptom_dataset/style.css">
    <link rel="stylesheet" href="../third_party/picnic/picnic.min.css">
    <link rel="stylesheet" href="../static/styles.min.css">

    <!-- Polyfills, custom functions and constants -->
    <script type="text/javascript" src="../static/polyfills.min.js"></script>
    <script type="text/javascript" src="../static/open-covid-19.min.js"></script>
    <script type="text/javascript">CACHE=window.CACHE||{JSON:{},CSV:{},gcharts:{}};const DEFAULT_OPTIONS={"data-url":"https://storage.googleapis.com/covid19-open-data","history-size-limit":0,"history-size-mobile":100,"skip-until-outbreak":!0,"outbreak-threshold-ratio":.05,"read-format":"JSON","shareable-charts":!0,"min-date":null,"max-date":null},CURRENT_OPTIONS=Object.keys(DEFAULT_OPTIONS).reduce((e,t)=>Object.assign(e,{[t]:sessionStorage.getItem(t)||DEFAULT_OPTIONS[t]}),{}),OPEN_COVID_CONFIG=Object.assign({tables:{index:"Index",demographics:"Demographics",economy:"Economy",epidemiology:"Epidemiology",geography:"Geography",health:"Health",hospitalizations:"Hospitalizations",mobility:"Mobility","oxford-government-response":"Oxford Government Response","lawatlas-emergency-declarations":"LawAtlas Emergency Declarations",weather:"Weather",worldbank:"Worldbank","by-age":"Breakdown by Age","by-sex":"Breakdown by Sex","google-search-trends":"Google Search Trends"}},CURRENT_OPTIONS);GOOGLE_CHARTS_CONFIG=window.GOOGLE_CHARTS_CONFIG||{theme:"material",colors:["#BF360C"],backgroundColor:{fill:"#FCFCFC"},legend:{position:CURRENT_OPTIONS.chart_legend_position||"none"},chartArea:{width:"100%",height:"100%",left:parseInt(CURRENT_OPTIONS.chart_padding_left||64),bottom:parseInt(CURRENT_OPTIONS.chart_padding_bottom||48),top:parseInt(CURRENT_OPTIONS.chart_padding_top||24)},titlePosition:"in",axisTitlesPosition:"in",hAxis:{textPosition:"bottom"},vAxis:{textPosition:"out",viewWindow:{min:0}},height:parseInt(CURRENT_OPTIONS.chart_height||300)};</script>


</head><body class="single-column">

    <!-- Header with links -->
    <header>
    <div class="glue-header__logo-container ">
        <a href="https://www.google.com/" style>
            <svg role="img" aria-hidden="true" class="glue-header__logo-svg">
                <use xlink:href="../glue/glue-icons.svg#google-color-logo"/>
            </svg>
        </a>
    </div>
</header>

<h1 class="centered glue-headline glue-headline--headline-1">
    <a href=".." style="text-decoration: none; color: initial;">COVID-19 Open-Data</a>
</h1>

    <div class="spacer"></div>

    <!-- Location search bar -->
    <div class="centered fullwidth">
    <input disabled id="location-selector" type="search" placeholder="Search for any location" results="0">
</div>
<script async>function searchify(e){return transliterate(e).toLocaleLowerCase()}function*filter(e,a,o){for(var n=0;o>0;){for(;n<e.length&&!a(e[n]);)n++;if(n>=e.length)return;yield e[n++],o--}}!async function(){const e=(await loadCSV(`${CURRENT_OPTIONS["data-url"]}/v3/demographics.csv`)).reduce((e,a)=>(e[a.location_key]=parseInt(a.population)||0,e),{}),a=(await loadCSV(`${CURRENT_OPTIONS["data-url"]}/v3/index.csv`)).map(a=>Object.assign({},a,{population:e[a.location_key]})).sort((e,a)=>(a.population||0)-(e.population||0)).map(e=>{let a="";switch(parseInt(e.aggregation_level)){case 0:return a=`<div>${e.country_name} <span class="mono">${e.location_key}</span></div>`,{value:e.location_key,label:a,match:searchify(a)};case 1:return a=`<div>${e.subregion1_name}, ${e.country_name} <span class="mono">${e.location_key}</span></div>`,{value:e.location_key,label:a,match:searchify(a)};case 2:return a=`<div>${e.subregion2_name}, ${e.subregion1_name} ${e.country_code} <span class="mono">${e.location_key}</span></div>`,{value:e.location_key,label:a,match:searchify(a)};case 3:return a=`<div>${e.locality_name}, ${e.subregion1_name} ${e.country_code} <span class="mono">${e.location_key}</span></div>`,{value:e.location_key,label:a,match:searchify(a)};default:console.error("Unknown aggregation level for record:"),console.error(e)}}).filter(e=>e&&e.value&&e.label);$("#location-selector").autocomplete({minLength:2,source:(e,o)=>{const n=searchify(e.term);return o(Array.from(filter(a,e=>-1!==e.match.indexOf(n),10)))},select:function(e,o){const n=o.item.value;-1!==a.map(e=>e.value).indexOf(n)&&window.goto(`?key=${n}`)},create:function(){$(this).data("ui-autocomplete")._renderItem=function(e,a){return $("<li></li>").data("item.autocomplete",a).append(a.label).appendTo(e)}}}),$("#location-selector").attr("disabled",!1),$("#location-selector").focus()}();</script>

    <div class="spacer"></div>
    <div class="spacer"></div>

    <main>
        <!-- Wrap the whole widget into a DIV -->
<div style="visibility: hidden;">
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>!async function(){const t=["wikidata_id","datacommons_id","openstreetmap_id"],e=document.currentScript.parentElement,n=new URLSearchParams(location.search).get("key");let a=await loadLocationData(n);if(a.filter(e=>t.some(t=>e[t]&&""!==e[t])).length<1)return console.error("Not enough records found for columns:",t),void(e.style.display="none");const o=attachElement("table",{className:"fullwidth"},e,prepend=!0);o.style.tableLayout="fixed";const i=a[0],r=(t=>0===t?i.country_name:1===t?i.subregion1_name:2===t?i.subregion2_name:3===t?i.locality_name:"Unknown")(Number(i.aggregation_level));let d=`<tr style="height: 2em;"><th colspan=2><span class="centered">${r}</span></th></tr>`;window.locationLabel=r;d+=`\n                <tr>\n                    <td>Aggregation Level</td>\n                    <td>${(t=>0===t?"Country":1===t?"Administrative Level 1":2===t?"Administrative Level 2":3===t?"Locality":"Unknown")(Number(i.aggregation_level))}</td>\n                </tr>`;const l=n.split("_").length,c=(t=>0===t?"World":1===t?`<a href="../report/index.html?key=${i.country_code}">${i.country_name}</a>`:2===t?`<a href="../report/index.html?key=${i.country_code}_${i.subregion1_code}">${i.subregion1_name}</a>`:3===t&&2===l?`<a href="../report/index.html?key=${i.country_code}">${i.country_name}</a>`:3===t&&3===l?`<a href="../report/index.html?key=${i.country_code}_${i.subregion1_code}">${i.subregion1_name}</a>`:3===t&&4===l?`<a href="../report/index.html?key=${i.country_code}_${i.subregion1_code}_${i.subregion2_code}">${i.subregion2_name}</a>`:"Unknown")(Number(i.aggregation_level));"World"!==c&&"Unknown"!==c&&(d+=`\n                    <tr>\n                        <td>Located in</td>\n                        <td>${c}</td>\n                    </tr>`),i.population&&(d+=`\n                    <tr>\n                        <td>Total Population</td>\n                        <td>${Number(i.population).toLocaleString()}</td>\n                    </tr>`);const s=a.filter(t=>t.cumulative_confirmed&&""!==t.cumulative_confirmed).slice(-1);s.length>0&&(d+=`\n                    <tr>\n                        <td>Total Confirmed Cases</td>\n                        <td>${Number(s[0].cumulative_confirmed).toLocaleString()}</td>\n                    </tr>`);const m=a.filter(t=>t.cumulative_deceased&&""!==t.cumulative_deceased).slice(-1);m.length>0&&(d+=`\n                    <tr>\n                        <td>Total Deceased Persons</td>\n                        <td>${Number(m[0].cumulative_deceased).toLocaleString()}</td>\n                    </tr>`);const u=a.filter(t=>t.cumulative_persons_vaccinated&&""!==t.cumulative_persons_vaccinated).slice(-1);u.length>0&&(d+=`\n                    <tr>\n                        <td>Total Vaccinated Persons</td>\n                        <td>${Number(u[0].cumulative_persons_vaccinated).toLocaleString()}</td>\n                    </tr>`),notNull=((t,e)=>parseInt(t[e])||null);const g=a.filter(t=>["new_confirmed","cumulative_confirmed"].some(e=>notNull(t,e))).slice(0,1);g.length>0&&(d+=`<tr><td>First Confirmed Case</td><td>${g[0].date}</td></tr>`);const _=a.filter(t=>["new_deceased","cumulative_deceased"].some(e=>notNull(t,e))).slice(0,1);_.length>0&&(d+=`<tr><td>First Deceased Person</td><td>${_[0].date}</td></tr>`);let p="";p+=`<a style="text-decoration: none;" href="${CURRENT_OPTIONS["data-url"]}/v3/location/${n}.csv" target="_blank">\n                    <img src="../static/csv-icon.svg" width=32 height=32 style="padding:8px 8px 0 0;" />\n                </a>`,i.wikidata_id&&(p+=`<a style="text-decoration: none;" href="https://www.wikidata.org/wiki/${i.wikidata_id}" target="_blank">\n                        <img src="../static/wikipedia.svg" width=32 height=32 style="padding:8px 8px 0 0;" />\n                    </a>`),i.datacommons_id&&(p+=`<a style="text-decoration: none;" href="https://datacommons.org/place?dcid=${i.datacommons_id}" target="_blank">\n                        <img src="../static/datacommons.png" width=32 height=32 style="padding:8px 8px 0 0;" />\n                    </a>`),i.openstreetmap_id&&(p+=`<a style="text-decoration: none;" href="https://www.openstreetmap.org/relation/${i.openstreetmap_id}" target="_blank">\n                        <img src="../static/openstreetmap.svg" width=32 height=32 style="padding:8px 8px 0 0;" />\n                    </a>`),d+=`<tr><td>Related Links</td><td>${p}</td></tr>`,o.innerHTML=d,o.parentElement.style.visibility="visible"}();</script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div id="partial-vaccinations" style="visibility: hidden;">
    <p class="chart-footer">
        Computed as the count of persons which have received at least one dose of a COVID-19 vaccine
    </p>
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>!async function(){const e=["new_persons_vaccinated","cumulative_persons_vaccinated","population"],t=document.currentScript.parentElement,a=new URLSearchParams(location.search).get("key");let n=await loadLocationData(a);if(n.filter(t=>e.every(e=>t[e]&&""!==t[e])).length<16)return console.error("Not enough records found for columns:",e),void(t.style.display="none");n=mapToNumeric(n,e,!0);const o=new Set(filterDataIndices(n,0,e.slice(0,-1))),i=(n=n.filter((e,t)=>o.has(t)).filter(t=>e.some(e=>!Number.isNaN(t[e]))))[0].population,c=n.map(e=>({Date:e.date,"Persons Vaccinated":e.new_persons_vaccinated,"Population Vaccination Rate":e.cumulative_persons_vaccinated/i}));await loadGoogleCharts(["corechart"]);const r=attachElement("div",{},t,!0);new google.visualization.ComboChart(r).draw(recordsToDataTable(c),Object.assign({},GOOGLE_CHARTS_CONFIG,{title:chartLabel("Persons vaccinated and population vaccination rate"),interpolateNulls:!0,colors:["#0277BD","#78002E"],curveType:"function",series:{0:{targetAxisIndex:0,type:"bars"},1:{targetAxisIndex:1,type:"line"}},vAxes:{1:{textPosition:"in",format:"#%"}}})),t.style.visibility="visible"}();</script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div id="confirmed-cases" style="visibility: hidden;">
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>!async function(){const e=["new_confirmed"],t=document.currentScript.parentElement,a=new URLSearchParams(location.search).get("key");let i=await loadLocationData(a);if(i.filter(t=>e.every(e=>t[e]&&""!==t[e])).length<20)return void(t.style.display="none");i=mapToNumeric(i,e,positive=!0);const n=new Set(filterDataIndices(i)),o=(i=i.filter((e,t)=>n.has(t)).filter(t=>e.some(e=>!Number.isNaN(t[e])))).map(e=>({Date:e.date,Cases:e.new_confirmed}));await loadGoogleCharts(["corechart"]);const r=attachElement("div",{},t,prepend=!0);new google.visualization.ColumnChart(r).draw(recordsToDataTable(o),Object.assign({},GOOGLE_CHARTS_CONFIG,{title:chartLabel("Confirmed cases"),colors:["#0277BD"]})),t.style.visibility="visible"}();</script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div id="confirmed-cases-100k" style="visibility: hidden;">
    <p class="chart-footer">
        Computed using a 14-day count of cases per 100,000 persons
    </p>
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>

        (async function () {
            const rollingWindowSize = 14;
            const minRows = 20 + rollingWindowSize;
            const columns = ['new_confirmed', 'population'];
            const rootElement = document.currentScript.parentElement;
            const title = `Confirmed cases and cases per 100,000 persons`;

            // Get the location key from the URL
            const locationKey = new URLSearchParams(location.search).get('key');

            // Load the location data using the location key
            let locationData = await loadLocationData(locationKey);

            // Early exit: there is not enough relevant data for this chart
            if (locationData.filter(row => columns.every(col => row[col] && row[col] !== '')).length < minRows) {
                console.error('Not enough records found for columns:', columns);
                rootElement.style.display = 'none';
                return;
            }

            // Convert the relevant rows to numbers
            locationData = mapToNumeric(locationData, columns, true);

            // Get rid of irrelevant data according to settings
            const indices = new Set(filterDataIndices(locationData, rollingWindowSize));
            locationData = locationData
                .filter((_, idx) => indices.has(idx))
                .filter(row => columns.some(col => !Number.isNaN(row[col])));

            // Use a moving average for the cases per 100K to avoid spikes
            const pop = locationData[0]['population'];
            const data = locationData.map((row, idx) => {
                const start = Math.max(0, idx - rollingWindowSize);
                const rollingSum = locationData.slice(start, idx).reduce((total, row) =>
                    total + (Number.isNaN(row.new_confirmed) ? 0 : row.new_confirmed), 0);
                const confirmedPer100k = rollingSum * 100_000 / pop;
                return {
                    ['Date']: row.date,
                    ['Confirmed Cases']: row.new_confirmed,
                    ['Cases per 100K']: confirmedPer100k,
                };
            }).slice(rollingWindowSize);

            await loadGoogleCharts(['corechart']);
            const elem = attachElement('div', {}, rootElement, true);
            const chartObject = new google.visualization.ComboChart(elem);
            chartObject.draw(recordsToDataTable(data), Object.assign({}, GOOGLE_CHARTS_CONFIG, {
                title: chartLabel(title),
                colors: ['#0277BD', '#78002E'],  // material light blue, dark pink
                curveType: 'function',
                series: {
                    0: { targetAxisIndex: 0, type: 'bars' },
                    1: { targetAxisIndex: 1, type: 'line' },
                },
                vAxes: {
                    1: {
                        textPosition: 'in',
                    },
                },
            }));

            // Unhide element
            rootElement.style.visibility = 'visible';

            // If this chart loaded correctly, we can get rid of the basic confirmed cases
            document.querySelector('#confirmed-cases').style.display = 'none';
        })();
    </script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div id="deceased-persons" style="visibility: hidden;">
    <p class="chart-footer">
        Mortality rate is computed using a 14-day moving average
    </p>
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>!async function(){const e=["new_confirmed","new_deceased"],t=document.currentScript.parentElement,a=new URLSearchParams(location.search).get("key");let n=await loadLocationData(a);if(n.filter(t=>e.every(e=>t[e]&&""!==t[e])).length<34)return console.error("Not enough records found for columns:",e),void(t.style.display="none");n=mapToNumeric(n,e,!0);const r=new Set(filterDataIndices(n,28));n=n.filter((e,t)=>r.has(t)).filter(t=>e.some(e=>!Number.isNaN(t[e])));let i=0;const o=n.map((e,t)=>{const a={Date:e.date,"Deceased Persons":e.new_deceased,"Mortality Rate":Number.NaN};if(i+=Number.isNaN(e.new_deceased)?0:e.new_deceased,t>28){const e=Math.max(0,t-14),r=n.slice(e,t).reduce((e,t)=>e+t.new_deceased,0),o=Math.max(0,t-28),s=n.slice(o,t).reduce((e,t)=>e+(t.new_confirmed||t.new_deceased),0),c=Math.min(1,r/(s||1));a["Mortality Rate"]=i<25?0:c<.5?Math.min(1,r/(s||1)):Number.NaN}return a}).slice(28);await loadGoogleCharts(["corechart"]);const s=attachElement("div",{},t,prepend=!0);new google.visualization.ComboChart(s).draw(recordsToDataTable(o),Object.assign({},GOOGLE_CHARTS_CONFIG,{title:chartLabel("Deceased persons and mortality rate"),colors:["#D32F2F","#757575"],curveType:"function",series:{0:{targetAxisIndex:0,type:"bars"},1:{targetAxisIndex:1,type:"line"}},vAxes:{1:{textPosition:"in",viewWindow:{min:0,max:.5}}}})),t.style.visibility="visible"}();</script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div id="active-cases" style="visibility: hidden;">
    <p class="chart-footer">
        Active cases are estimated as the 14-day rolling sum of cases
    </p>
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>!async function(){const e=["date","new_confirmed"],t=document.currentScript.parentElement,a=new URLSearchParams(location.search).get("key");let i=await loadLocationData(a);if(i.filter(t=>e.every(e=>t[e]&&""!==t[e])).length<34)return void(t.style.display="none");i=mapToNumeric(i,e.slice(1),!0);const r=new Set(filterDataIndices(i,pad=14)),c=(i=i.filter((e,t)=>r.has(t)).filter(t=>e.some(e=>!Number.isNaN(t[e])))).map((e,t)=>{const a=Math.max(0,t-14),r=i.slice(a,t).reduce((e,t)=>e+(Number.isNaN(t.new_confirmed)?0:t.new_confirmed),0);return{Date:e.date,"Estimated Active Cases":r}}).slice(14);await loadGoogleCharts(["corechart"]);const n=attachElement("div",{},t,prepend=!0);new google.visualization.AreaChart(n).draw(recordsToDataTable(c),Object.assign({},GOOGLE_CHARTS_CONFIG,{title:chartLabel("Estimated active cases"),curveType:"function",colors:["#FFA726"]})),t.style.visibility="visible"}();</script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div style="visibility: hidden;">
    <p class="chart-footer">
        Positivity rate is computed using a 7-day moving average
    </p>
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>!async function(){const e=["new_confirmed","new_tested"],t=document.currentScript.parentElement,i=new URLSearchParams(location.search).get("key");let n=await loadLocationData(i);if(n.filter(t=>e.every(e=>t[e]&&""!==t[e])).length<27)return console.error("Not enough records found for columns:",e),void(t.style.display="none");n=mapToNumeric(n,e,positive=!0);const a=new Set(filterDataIndices(n,7,["new_tested"]));n=n.filter((e,t)=>a.has(t)).filter(t=>e.some(e=>!Number.isNaN(t[e])));let s=0;const o=n.map((e,t)=>{const i={Date:e.date,"Tested Persons":e.new_tested,"Positivity Rate":Number.NaN};if(s+=Number.isNaN(e.new_tested)?0:e.new_tested,t>7){const e=Math.max(0,t-7),a=n.slice(e,t).reduce((e,t)=>e+t.new_confirmed,0),o=n.slice(e,t).reduce((e,t)=>e+(t.new_tested||t.new_confirmed),0),r=Math.min(1,a/o);i["Positivity Rate"]=s<100?0:r<1?r:Number.NaN}return i}).slice(7);await loadGoogleCharts(["corechart"]);const r=attachElement("div",{},t,prepend=!0);new google.visualization.ComboChart(r).draw(recordsToDataTable(o),Object.assign({},GOOGLE_CHARTS_CONFIG,{title:chartLabel("Tests Performed and Positivity Rate"),colors:["#009688","#536DFE"],curveType:"function",series:{0:{targetAxisIndex:0,type:"bars"},1:{targetAxisIndex:1,type:"line"}},vAxes:{1:{textPosition:"in",viewWindow:{min:0,max:1}}}})),t.style.visibility="visible"}();</script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div id="age-stratified-active-cases" style="visibility: hidden;">
    <p class="chart-footer">
        Infection rates are computed as the 14-day count of cases per 1,000 persons
    </p>
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>

        (async function () {
            const rollingWindowSize = 14;
            const minRows = 20 + rollingWindowSize;
            const columns = [
                'age_bin_0',
                'age_bin_1',
                'age_bin_2',
                'age_bin_3',
                'age_bin_4',
                'age_bin_5',
                'age_bin_6',
                'age_bin_7',
                'age_bin_8',
                'age_bin_9',
                'new_confirmed_age_0',
                'new_confirmed_age_1',
                'new_confirmed_age_2',
                'new_confirmed_age_3',
                'new_confirmed_age_4',
                'new_confirmed_age_5',
                'new_confirmed_age_6',
                'new_confirmed_age_7',
                'new_confirmed_age_8',
                'new_confirmed_age_9',
                'population_age_00_09',
                'population_age_10_19',
                'population_age_20_29',
                'population_age_30_39',
                'population_age_40_49',
                'population_age_50_59',
                'population_age_60_69',
                'population_age_70_79',
                'population_age_80_and_older',
            ];
            const rootElement = document.currentScript.parentElement;
            const title = `Infection rates by age group`;

            // Get the location key from the URL
            const locationKey = new URLSearchParams(location.search).get('key');

            // Load the location data using the location key
            let locationData = await loadLocationData(locationKey);

            // Early exit: there is not enough relevant data for this chart
            const requiredColumns = ['age_bin_0', 'new_confirmed_age_0', 'population_age_00_09'];
            if (locationData.filter(row => requiredColumns.every(col => row[col] && row[col] !== '')).length < minRows) {
                console.error('Not enough records found for columns:', requiredColumns);
                rootElement.style.display = 'none';
                return;
            }

            // Convert the relevant rows to numbers
            const confirmedColumns = columns.filter(col => col.startsWith('new_confirmed_age_'));
            const numColumns = columns.filter(col => !col.startsWith('age_bin_'));
            locationData = mapToNumeric(locationData, numColumns, true);

            // Get rid of irrelevant data according to settings
            const indices = new Set(filterDataIndices(locationData, rollingWindowSize, confirmedColumns));
            locationData = locationData
                .filter((_, idx) => indices.has(idx))
                .filter(row => columns.some(col => !Number.isNaN(row[col])));

            // Special case: merge 80-90 and 90-100 and 100+
            locationData = mergeAgeBins(locationData, 'new_deceased');

            // Get the latest data for each column
            const latest = locationData.reduce((acc, row) => {
                const recordColumns = Object.keys(row);
                columns.forEach(col => {
                    if (recordColumns.includes(col) && row[col] !== '' && !Number.isNaN(row[col])) {
                        acc[col] = row[col];
                    }
                });
                return acc;
            }, {});

            // Ensure the age bins are monotonically increasing
            const ageBins = Object.keys(latest)
                .filter(col => col.startsWith('age_bin_'))
                .filter((col, idx, arr) => {
                    if (idx === arr.length - 1) return true;
                    const [lo0, hi0] = latest[col].replace('+', '').split('-').map(Number);
                    const [lo1, hi1] = latest[arr[idx + 1]].replace('+', '').split('-').map(Number);
                    return hi0 > 0 && hi0 < lo1;
                });

            // Map from new_confirmed_x to corresponding age bin XX-YY
            const ageBinConfirmedMap = locationData.reduce((acc, row) => {
                columns.forEach(col => {
                    const binColumn = `age_bin_${col.split('_').slice(-1)[0]}`;
                    if (row[binColumn] && ageBins.includes(binColumn)) acc[col] = row[binColumn];
                });
                return acc;
            }, {});

            // List of age bins found in the data
            const ageBinConfirmedList = Object.keys(ageBinConfirmedMap).map(col => ageBinConfirmedMap[col]);

            // Map from population_age_xx_yy to corresponding population estimate
            const populationAgeBins = Object.keys(locationData[0])
                .filter(col => col.startsWith('population_age_'))
                .reduce((acc, col) => Object.assign(acc, { [col]: locationData[0][col] }), {});

            // Build the adapter to get the population estimate for any age bin
            const ageBinConfirmedAdapter = ageBinAdapterBuilder(ageBinConfirmedList, populationAgeBins);

            // Compute a rolling sum to estimate active cases and divide by age band population
            const data = locationData.map((row, idx) => {
                const record = { 'Date': row.date };
                const startIdx = Math.max(0, idx - rollingWindowSize);

                confirmedColumns.forEach(col => {
                    if (!(col in ageBinConfirmedMap)) return;
                    const ageBin = ageBinConfirmedMap[col];
                    const binLabel = ageBin.endsWith('-') ? ageBin.replace('-', '+') : ageBin;
                    const binPopulation = ageBinConfirmedAdapter[ageBin];

                    const rollingSum = locationData.slice(startIdx, idx)
                        .reduce((total, row) => total + (parseInt(row[col]) || 0), 0);

                    record[binLabel] = 1_000 * rollingSum / binPopulation;
                });
                return record;
            }).slice(rollingWindowSize);

            // Compute a linear color scale
            const rgb0 = [244, 244, 24];
            const rgb1 = [12, 122, 244];
            const ageBucketCount = Object.keys(data[0]).length - 1;
            const colors = Array.from(colorScaleGenerator(rgb0, rgb1, ageBucketCount));

            // Make sure Google Charts loads and attach element to page
            await loadGoogleCharts(['corechart']);
            const elem = attachElement('div', {}, rootElement, true);
            const chartObject = new google.visualization.LineChart(elem);
            chartObject.draw(recordsToDataTable(data), Object.assign({}, GOOGLE_CHARTS_CONFIG, {
                title: chartLabel(title),
                curveType: 'function',
                legend: { position: 'in' },
                interpolateNulls: true,
                colors: colors,
            }));

            // Unhide element
            rootElement.style.visibility = 'visible';
        })();
    </script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div id="age-stratified-active-cases" style="visibility: hidden;">
    <p class="chart-footer">
        Active cases are estimated as the 14-day count of cases
    </p>
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>!async function(){const e=["age_bin_0","age_bin_1","age_bin_2","age_bin_3","age_bin_4","age_bin_5","age_bin_6","age_bin_7","age_bin_8","age_bin_9","new_confirmed_age_0","new_confirmed_age_1","new_confirmed_age_2","new_confirmed_age_3","new_confirmed_age_4","new_confirmed_age_5","new_confirmed_age_6","new_confirmed_age_7","new_confirmed_age_8","new_confirmed_age_9"],n=document.currentScript.parentElement,a=new URLSearchParams(location.search).get("key");let t=await loadLocationData(a);const r=["age_bin_0","new_confirmed_age_0"];if(t.filter(e=>r.every(n=>e[n]&&""!==e[n])).length<34)return console.error("Not enough records found for columns:",e),void(n.style.display="none");const i=e.filter(e=>!e.startsWith("age_bin_"));t=mapToNumeric(t,i,!0);const c=e.filter(e=>e.startsWith("new_confirmed_age_")),o=new Set(filterDataIndices(t,14,c));t=t.filter((e,n)=>o.has(n)).filter(n=>e.some(e=>!Number.isNaN(n[e])));const s=(t=mergeAgeBins(t,"new_confirmed")).reduce((n,a)=>{const t=Object.keys(a);return e.forEach(e=>{t.includes(e)&&""!==a[e]&&!Number.isNaN(a[e])&&(n[e]=a[e])}),n},{}),_=Object.keys(s).filter(e=>e.startsWith("age_bin_")).filter((e,n,a)=>{if(n===a.length-1)return!0;const[t,r]=s[e].replace("+","").split("-").map(Number),[i,c]=s[a[n+1]].replace("+","").split("-").map(Number);return r>0&&r<i}),l=t.reduce((n,a)=>(e.filter(e=>!e.startsWith("age_bin_")).forEach(e=>{const t=`age_bin_${e.split("_").slice(-1)[0]}`;a[t]&&_.includes(t)&&(n[e]=a[t])}),n),{}),g=t.map((n,a)=>{const r={Date:n.date},i=Math.max(0,a-14);return e.forEach(e=>{const n=l[e];if(!n)return;const c=n.endsWith("-")?n.replace("-","+"):n;t.slice(i,a).map(n=>n[e]).every(e=>Number.isNaN(e))?r[c]=Number.NaN:r[c]=t.slice(i,a).reduce((n,a)=>n+(Number.isNaN(a[e])?0:a[e]),0)}),r}).slice(14);console.log(g);const d=Object.keys(g[0]).length-1;await loadGoogleCharts(["corechart"]);const m=attachElement("div",{},n,prepend=!0);new google.visualization.AreaChart(m).draw(recordsToDataTable(g),Object.assign({},GOOGLE_CHARTS_CONFIG,{title:chartLabel("Estimated active cases by age group"),isStacked:!0,curveType:"function",interpolateNulls:!0,legend:{position:"in"},colors:Array.from(colorScaleGenerator([244,244,24],[12,122,244],d))})),n.style.visibility="visible",document.querySelector("#active-cases").style.display="none"}();</script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div id="age-stratified-active-cases" style="visibility: hidden;">
    <p class="chart-footer">
        Computed as the 14-day count of deaths per 100,000 persons
    </p>
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>

        (async function () {
            const rollingWindowSize = 14;
            const minRows = 20 + rollingWindowSize;
            const columns = [
                'age_bin_0',
                'age_bin_1',
                'age_bin_2',
                'age_bin_3',
                'age_bin_4',
                'age_bin_5',
                'age_bin_6',
                'age_bin_7',
                'age_bin_8',
                'age_bin_9',
                'new_deceased_age_0',
                'new_deceased_age_1',
                'new_deceased_age_2',
                'new_deceased_age_3',
                'new_deceased_age_4',
                'new_deceased_age_5',
                'new_deceased_age_6',
                'new_deceased_age_7',
                'new_deceased_age_8',
                'new_deceased_age_9',
                'population_age_00_09',
                'population_age_10_19',
                'population_age_20_29',
                'population_age_30_39',
                'population_age_40_49',
                'population_age_50_59',
                'population_age_60_69',
                'population_age_70_79',
                'population_age_80_and_older',
            ];
            const rootElement = document.currentScript.parentElement;
            const title = `Deaths per 100,000 persons by age group`;

            // Get the location key from the URL
            const locationKey = new URLSearchParams(location.search).get('key');

            // Load the location data using the location key
            let locationData = await loadLocationData(locationKey);

            // Early exit: there is not enough relevant data for this chart
            const requiredColumns = ['age_bin_0', 'population_age_00_09'];
            if (locationData.filter(row => requiredColumns.every(col => row[col] && row[col] !== '')).length < minRows) {
                console.error('Not enough records found for columns:', requiredColumns);
                rootElement.style.display = 'none';
                return;
            }

            // Early exit: there is not enough relevant data for this chart
            const optionalColumns = [
                'new_deceased_age_0',
                'new_deceased_age_1',
                'new_deceased_age_2',
            ];
            if (locationData.filter(row => optionalColumns.some(col => row[col] !== null)).length < minRows) {
                console.error('Not enough records found for columns:', optionalColumns);
                rootElement.style.display = 'none';
                return;
            }

            // Convert the relevant rows to numbers
            const numColumns = columns.filter(col => !col.startsWith('age_bin_'));
            locationData = mapToNumeric(locationData, numColumns, true);

            // Get rid of irrelevant data according to settings
            const deceasedColumns = columns.filter(col => col.startsWith('new_deceased_age_'));
            const indices = new Set(filterDataIndices(locationData, rollingWindowSize, deceasedColumns));
            locationData = locationData
                .filter((_, idx) => indices.has(idx))
                .filter(row => columns.some(col => !Number.isNaN(row[col])));

            // Special case: merge 80-90 and 90-100 and 100+
            locationData = mergeAgeBins(locationData, 'new_deceased');

            // Get the latest data for each column
            const latest = locationData.reduce((acc, row) => {
                const recordColumns = Object.keys(row);
                columns.forEach(col => {
                    if (recordColumns.includes(col) && row[col] !== '' && !Number.isNaN(row[col])) {
                        acc[col] = row[col];
                    }
                });
                return acc;
            }, {});

            // Ensure the age bins are monotonically increasing
            const ageBins = Object.keys(latest)
                .filter(col => col.startsWith('age_bin_'))
                .filter((col, idx, arr) => {
                    if (idx === arr.length - 1) return true;
                    const [lo0, hi0] = latest[col].replace('+', '').split('-').map(Number);
                    const [lo1, hi1] = latest[arr[idx + 1]].replace('+', '').split('-').map(Number);
                    return hi0 > 0 && hi0 < lo1;
                });

            // Map from new_deceased_x to corresponding age bin XX-YY
            const ageBinDeceasedMap = locationData.reduce((acc, row) => {
                columns.forEach(col => {
                    const binColumn = `age_bin_${col.split('_').slice(-1)[0]}`;
                    if (row[binColumn] && ageBins.includes(binColumn)) acc[col] = row[binColumn];
                });
                return acc;
            }, {});

            // List of age bins found in the data
            const ageBinDeceasedList = Object.keys(ageBinDeceasedMap).map(col => ageBinDeceasedMap[col]);

            // Map from population_age_xx_yy to corresponding population estimate
            const populationAgeBins = Object.keys(locationData[0])
                .filter(col => col.startsWith('population_age_'))
                .reduce((acc, col) => Object.assign(acc, { [col]: locationData[0][col] }), {});

            // Build the adapter to get the population estimate for any age bin
            const ageBinDeceasedAdapter = ageBinAdapterBuilder(ageBinDeceasedList, populationAgeBins);

            // Use a moving average for the mortality rate to avoid spikes
            const data = locationData.map((row, idx) => {
                const record = { 'Date': row.date };
                const startIdx = Math.max(0, idx - rollingWindowSize);

                deceasedColumns.forEach(col => {
                    if (!(col in ageBinDeceasedMap)) return;
                    const ageBin = ageBinDeceasedMap[col];
                    const binLabel = ageBin.endsWith('-') ? ageBin.replace('-', '+') : ageBin;
                    const binPopulation = ageBinDeceasedAdapter[ageBin];

                    const rollingSum = locationData.slice(startIdx, idx)
                        .reduce((total, row) => total + row[col], 0);

                    record[binLabel] = 100_000 * rollingSum / binPopulation;
                })

                return record;
            }).slice(rollingWindowSize);

            // Compute a linear color scale
            const rgb0 = [244, 244, 24];
            const rgb1 = [12, 122, 244];
            const ageBucketCount = Object.keys(data[0]).length - 1;

            // Make sure Google Charts loads and attach element to page
            await loadGoogleCharts(['corechart']);
            const elem = attachElement('div', {}, rootElement, true);
            const chartObject = new google.visualization.LineChart(elem);
            chartObject.draw(recordsToDataTable(data), Object.assign({}, GOOGLE_CHARTS_CONFIG, {
                title: chartLabel(title),
                curveType: 'function',
                legend: { position: 'in' },
                colors: Array.from(colorScaleGenerator(rgb0, rgb1, ageBucketCount)),
                interpolateNulls: true,
            }));

            // Unhide element
            rootElement.style.visibility = 'visible';
        })();
    </script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div id="age-stratified-active-cases" style="visibility: hidden;">
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>!async function(){const e=["age_bin_0","age_bin_1","age_bin_2","age_bin_3","age_bin_4","age_bin_5","age_bin_6","age_bin_7","age_bin_8","age_bin_9","cumulative_deceased_age_0","cumulative_deceased_age_1","cumulative_deceased_age_2","cumulative_deceased_age_3","cumulative_deceased_age_4","cumulative_deceased_age_5","cumulative_deceased_age_6","cumulative_deceased_age_7","cumulative_deceased_age_8","cumulative_deceased_age_9","cumulative_confirmed_age_0","cumulative_confirmed_age_1","cumulative_confirmed_age_2","cumulative_confirmed_age_3","cumulative_confirmed_age_4","cumulative_confirmed_age_5","cumulative_confirmed_age_6","cumulative_confirmed_age_7","cumulative_confirmed_age_8","cumulative_confirmed_age_9"],a=document.currentScript.parentElement,t=new URLSearchParams(location.search).get("key");let i=await loadLocationData(t);const _=["age_bin_0","population_age_00_09"];if(i.filter(e=>_.every(a=>e[a]&&""!==e[a])).length<1)return console.error("Not enough records found for columns:",_),void(a.style.display="none");const c=["cumulative_deceased_age_0","cumulative_deceased_age_1","cumulative_deceased_age_2"];if(i.filter(e=>c.some(a=>e[a]&&""!==e[a])).length<1)return console.error("Not enough records found for columns:",c),void(a.style.display="none");const o=["cumulative_confirmed_age_0","cumulative_confirmed_age_1","cumulative_confirmed_age_2"];if(i.filter(e=>o.some(a=>e[a]&&""!==e[a])).length<1)return console.error("Not enough records found for columns:",o),void(a.style.display="none");const n=e.filter(e=>!e.startsWith("age_bin_"));i=mapToNumeric(i,n,!0);const r=new Set(filterDataIndices(i));i=i.filter((e,a)=>r.has(a)).filter(a=>e.some(e=>!Number.isNaN(a[e]))),i=mergeAgeBins(i,"new_deceased");const u=(i=mergeAgeBins(i,"new_confirmed")).reduce((a,t)=>{const i=Object.keys(t);return e.forEach(e=>{i.includes(e)&&""!==t[e]&&!Number.isNaN(t[e])&&(a[e]=t[e])}),a},{}),l=Object.keys(u).filter(e=>e.startsWith("age_bin_")).filter((e,a,t)=>{if(a===t.length-1)return!0;const[i,_]=u[e].replace("+","").split("-").map(Number),[c,o]=u[t[a+1]].replace("+","").split("-").map(Number);return _>0&&_<c}).map((e,a)=>{const[t,i]=u[e].split("-");return{"Age Group":`${t}${""===i?"+":"-"+i}`,"Mortality Rate":u[`cumulative_deceased_age_${a}`]/u[`cumulative_confirmed_age_${a}`]}});await loadGoogleCharts(["corechart"]);const s=attachElement("div",{},a,!0),m=new google.visualization.ColumnChart(s),d=Object.assign({},GOOGLE_CHARTS_CONFIG,{title:chartLabel("Cumulative mortality rates by age group"),colors:["#757575"],vAxis:{textPosition:"out",viewWindow:{min:0},format:"#%"},hAxis:{textPosition:"bottom",slantedText:!1,slantedTextAngle:0}});d.chartArea=Object.assign({},d.chartArea,{bottom:32}),m.draw(recordsToDataTable(l),d),a.style.visibility="visible"}();</script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div style="visibility: hidden;">
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>!async function(){const e=["population_age_00_09","population_age_80_and_older"],t=document.currentScript.parentElement,a=new URLSearchParams(location.search).get("key");let o=await loadLocationData(a);if(o.filter(t=>e.every(e=>t[e]&&""!==t[e])).length<1)return console.error("Not enough records found for columns:",e),void(t.style.display="none");const n=o[0],r=Object.keys(o[0]).filter(e=>e.startsWith("population_age_")).map(e=>({"Age Group":e.replace("population_age_","").replace("_and_older","+").replace("_","-"),Population:parseInt(n[e])}));await loadGoogleCharts(["corechart"]);const i=attachElement("div",{},t,prepend=!0),l=new google.visualization.ColumnChart(i),s=Object.assign({},GOOGLE_CHARTS_CONFIG,{title:chartLabel("Age-stratified demographics"),colors:["#4E342E"],vAxis:{textPosition:"out",viewWindow:{min:0}},hAxis:{textPosition:"bottom",slantedText:!1,slantedTextAngle:0}});s.chartArea=Object.assign({},s.chartArea,{bottom:32}),l.draw(recordsToDataTable(r),s),i.parentElement.style.visibility="visible"}();</script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div style="visibility: hidden;">
    <p class="chart-footer">
        Data from <a href="https://github.com/GoogleCloudPlatform/covid-19-open-data/blob/main/docs/table-mobility.md" target="_blank">
            Google's Mobility Reports
        </a>
    </p>
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>!async function(){const t=["mobility_residential","mobility_parks","mobility_grocery_and_pharmacy","mobility_transit_stations","mobility_workplaces","mobility_retail_and_recreation"],i=document.currentScript.parentElement,e=new URLSearchParams(location.search).get("key");let o=await loadLocationData(e);if(o.filter(i=>t.every(t=>i[t]&&""!==i[t])).length<20)return console.error("Not enough records found for columns:",t),void(i.style.display="none");o=mapToNumeric(o,t,positive=!1);const a=new Set(filterDataIndices(o));o=o.filter((t,i)=>a.has(i)).filter(i=>t.some(t=>!Number.isNaN(i[t])));const r={mobility_residential:"#D56E0C",mobility_parks:"#188038",mobility_grocery_and_pharmacy:"#129EAF",mobility_transit_stations:"#D01884",mobility_workplaces:"#8430CE",mobility_retail_and_recreation:"#1967D2"},n=o.map(i=>{const e={Date:i.date};return t.forEach(t=>e[(t=>t.split("_").slice(1).join(" "))(t)]=i[t]),e});await loadGoogleCharts(["corechart"]);const l=attachElement("div",{},i,prepend=!0);new google.visualization.AreaChart(l).draw(recordsToDataTable(n),Object.assign({},GOOGLE_CHARTS_CONFIG,{title:chartLabel("Google Mobility Reports"),curveType:"function",legend:{position:"in"},vAxis:{textPosition:"out"},colors:t.map(t=>r[t])})),l.parentElement.style.visibility="visible"}();</script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div style="visibility: hidden;">
    <p class="chart-footer">
        Data from <a href="https://github.com/GoogleCloudPlatform/covid-19-open-data/blob/main/docs/table-search-trends.md" target="_blank">
            Google's Search Trends
        </a>
    </p>
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>!async function(){const e=["search_trends_fever","search_trends_cough","search_trends_common_cold","search_trends_fatigue","search_trends_shortness_of_breath","search_trends_sputum","search_trends_myalgia","search_trends_chills","search_trends_dizziness","search_trends_headache","search_trends_sore_throat","search_trends_nausea","search_trends_vomiting","search_trends_diarrhea"],r=document.currentScript.parentElement,t=new URLSearchParams(location.search).get("key");let s=await loadLocationData(t);if(s.filter(r=>e.some(e=>r[e]&&""!==r[e])).length<20)return console.error("Not enough records found for columns:",e),void(r.style.display="none");s=mapToNumeric(s,e,positive=!1);const a=new Set(filterDataIndices(s));s=s.filter((e,r)=>a.has(r)).filter(r=>e.some(e=>!Number.isNaN(r[e])));const n=s.map(r=>{const t={Date:r.date};return e.forEach(e=>t[(e=>e.split("_").slice(2).join(" "))(e)]=r[e]),t});await loadGoogleCharts(["corechart"]);const o=attachElement("div",{},r,prepend=!0);new google.visualization.LineChart(o).draw(recordsToDataTable(n),Object.assign({},GOOGLE_CHARTS_CONFIG,{title:chartLabel("Google Search Trends"),curveType:"function",legend:{position:"in"},colors:void 0})),o.parentElement.style.visibility="visible"}();</script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div style="visibility: hidden;">
    <p class="chart-footer">
        Data from <a href="https://github.com/GoogleCloudPlatform/covid-19-open-data/blob/main/docs/table-government-response.md" target="_blank">
            Oxford's Government Response Dataset
        </a>
    </p>
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>!async function(){const e=["facial_coverings","school_closing","workplace_closing","restrictions_on_gatherings","restrictions_on_internal_movement"],t=document.currentScript.parentElement,o=new URLSearchParams(location.search).get("key");let n=await loadLocationData(o);if(n.filter(t=>e.some(e=>t[e]&&""!==t[e])).length<20)return console.error("Not enough records found for columns:",e),void(t.style.display="none");n=mapToNumeric(n,e,positive=!1);const a=new Set(filterDataIndices(n));n=n.filter((e,t)=>a.has(t)).filter(t=>e.some(e=>!Number.isNaN(t[e])));const r=n.map(t=>{const o={Date:t.date};return e.forEach(e=>o[(e=>e.replace(/'_'/g," "))(e)]=t[e]),o});await loadGoogleCharts(["corechart"]);const i=attachElement("div",{},t,prepend=!0);new google.visualization.LineChart(i).draw(recordsToDataTable(r),Object.assign({},GOOGLE_CHARTS_CONFIG,{title:chartLabel("Oxford's Government Response Metrics"),legend:{position:"in"},colors:void 0})),i.parentElement.style.visibility="visible"}();</script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div style="visibility: hidden;">
    <p class="chart-footer">
        Data from <a href="https://www.ncei.noaa.gov" target="_blank">NOAA</a>
    </p>
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>!async function(){const e=["relative_humidity","average_temperature_celsius","minimum_temperature_celsius","maximum_temperature_celsius"],t=document.currentScript.parentElement,a=new URLSearchParams(location.search).get("key");let i=await loadLocationData(a);if(i.filter(t=>e.every(e=>t[e]&&""!==t[e])).length<20)return console.error("Not enough records found for columns:",e),void(t.style.display="none");i=mapToNumeric(i,e,positive=!1);const r=new Set(filterDataIndices(i));i=i.filter((e,t)=>r.has(t)).filter(t=>e.some(e=>!Number.isNaN(t[e])));const n=i.map(t=>{const a={Date:t.date};return e.forEach(e=>a[(e=>e.replace("_celsius","").replace("_temperature","").replace(/_/g," "))(e)]=t[e]),a});await loadGoogleCharts(["corechart"]);const l=e=>e.toLocaleString(void 0,{maximumFractionDigits:1}),o=e=>`${e.Date}\n`+`${l(e.average)}°C `+`(Max ${l(e.maximum)} — Min ${l(e.minimum)})`,m=new google.visualization.DataTable;m.addColumn({id:"Date",type:"string"}),m.addColumn({id:"humidity",type:"number",role:"data",label:"Relative Humidity"}),m.addColumn({id:"average",type:"number",role:"data",label:"Temperature"}),m.addColumn({id:"minimum",type:"number",role:"interval"}),m.addColumn({id:"maximum",type:"number",role:"interval"}),m.addColumn({type:"string",role:"tooltip"}),m.addRows(n.map(e=>[e.Date,e["relative humidity"],e.average,e.minimum,e.maximum,o(e)]));const s=attachElement("div",{},t,prepend=!0);new google.visualization.LineChart(s).draw(m,Object.assign({},GOOGLE_CHARTS_CONFIG,{title:chartLabel("Relative humidity and temperature in Celsius"),legend:"in",curveType:"function",series:{0:{targetAxisIndex:1,type:"line",color:"#325CA8"},1:{targetAxisIndex:0,type:"line",color:"#FFC107"}},intervals:{style:"area"},vAxes:{1:{textPosition:"in"}}})),t.style.visibility="visible"}();</script>
</div>

        <!-- Wrap the whole widget into a DIV -->
<div style="visibility: hidden;">
    <div class="spacer"></div>
    <div class="spacer"></div>

    <script async>!async function(){const t=document.currentScript.parentElement,e=new URLSearchParams(location.search).get("key");let a=await loadLocationData(e);if(a.length<1)return console.error("Not enough records found for columns:",columns),void(t.style.display="none");const n=attachElement("details",{},root=t,prepend=!0),o=(attachElement("summary",{innerHTML:"Show the latest data for this location"},n),attachElement("table",{className:"fullwidth"},n));o.style.tableLayout="fixed";const l=a.slice(-1)[0];let s='<tr><th colspan=2><span class="centered">Latest Location Data</span></th></tr>';Object.keys(l).forEach(t=>{const e=a.filter(e=>e[t]&&""!==e[t]).slice(-1)[0]||{};e[t]&&(s+=`<tr><td>${t}</td><td>${e[t]}</td></tr>`)}),o.innerHTML=s,n.parentElement.style.visibility="visible"}();</script>
</div>
    </main>

    <!-- Footer with links -->
    <footer class="glue-footer glue-mod-spacer-3-top">
    <section class="glue-footer__global">
        <div class="glue-footer__logo">
            <a href="https://www.google.com" title="Google">
                <svg role="img" aria-hidden="true" class="glue-footer__logo-img">
                    <use xlink:href="../glue/glue-icons.svg#google-solid-logo"/>
                </svg>
            </a>
        </div>

        <ul class="glue-footer__global-links glue-no-bullet">
            <li class="glue-footer__global-links-list-item">
                <a class="glue-footer__link" href="https://goo.gle/covid-19-open-data">
                    Dataset
                </a>
            </li>

            <li class="glue-footer__global-links-list-item">
                <a class="glue-footer__link" href="https://policies.google.com/privacy">
                    Privacy
                </a>
            </li>

            <li class="glue-footer__global-links-list-item">
                <a class="glue-footer__link" href="https://policies.google.com/terms">
                    Terms
                </a>
            </li>
        </ul>

        <ul class="glue-footer__global-links glue-footer__global-links--extra glue-no-bullet">
            <li class="glue-footer__global-links-list-item glue-footer__global-links-list-item--extra">
                <a class="glue-footer__link false" href="https://github.com/open-covid-19/explorer.git">
                    Visualization Code
                </a>
            </li>
        </ul>


    </section>
</footer>

    <!-- Load analytics at the end of the page -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-53249564-6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-53249564-6");</script>



</body></html>